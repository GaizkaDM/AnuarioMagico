<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="org.GaizkaFrost.controllers.EditController"
            stylesheets="@../styles/form.css"
            styleClass="form-root">

    <top>
        <HBox alignment="CENTER" styleClass="header-container">
             <padding>
                <Insets top="20" bottom="10"/>
            </padding>
            <Label fx:id="lblTitulo" text="%edit.title.add" styleClass="form-title"/>
        </HBox>
    </top>

    <center>
        <ScrollPane fx:id="editScrollPane" fitToWidth="true" styleClass="form-scroll">
            <VBox spacing="20" styleClass="form-container">
                <padding>
                    <Insets top="20" right="30" bottom="30" left="30"/>
                </padding>

                <!-- SECTION 1: HEADER & CORE INFO -->
                <HBox spacing="30" alignment="TOP_CENTER">
                    <!-- Image Upload Section -->
                    <VBox spacing="10" alignment="CENTER" styleClass="image-section">
                        <ImageView fx:id="imgPreview" fitWidth="200" fitHeight="250" preserveRatio="true" styleClass="image-preview"/>
                        <Button fx:id="btnSeleccionarFoto" text="%edit.image.select" styleClass="secondary-button"/>
                        <Label text="%edit.required" styleClass="required-label"/>
                    </VBox>

                    <!-- Main Fields (Matching DetailView) -->
                    <GridPane hgap="15" vgap="10" HBox.hgrow="ALWAYS">
                        <columnConstraints>
                            <ColumnConstraints hgrow="NEVER" minWidth="100"/>
                            <ColumnConstraints hgrow="ALWAYS"/>
                        </columnConstraints>

                        <!-- Basic Identity -->
                        <Label text="%edit.label.name" GridPane.rowIndex="0" GridPane.columnIndex="0" styleClass="field-label"/>
                        <TextField fx:id="txtNombre" GridPane.rowIndex="0" GridPane.columnIndex="1"/>

                        <Label text="%edit.label.house" GridPane.rowIndex="1" GridPane.columnIndex="0" styleClass="field-label"/>
                        <ComboBox fx:id="comboCasa" GridPane.rowIndex="1" GridPane.columnIndex="1" maxWidth="Infinity"/>

                        <Label text="%edit.label.status" GridPane.rowIndex="2" GridPane.columnIndex="0" styleClass="field-label"/>
                        <ComboBox fx:id="comboEstado" GridPane.rowIndex="2" GridPane.columnIndex="1" maxWidth="Infinity"/>

                        <Label text="%edit.label.species" GridPane.rowIndex="3" GridPane.columnIndex="0" styleClass="field-label"/>
                        <TextField fx:id="txtEspecie" GridPane.rowIndex="3" GridPane.columnIndex="1"/>

                        <Label text="%edit.label.gender" GridPane.rowIndex="4" GridPane.columnIndex="0" styleClass="field-label"/>
                        <ComboBox fx:id="comboGenero" GridPane.rowIndex="4" GridPane.columnIndex="1" maxWidth="Infinity"/>
                        
                        <Label text="%edit.label.nationality" GridPane.rowIndex="5" GridPane.columnIndex="0" styleClass="field-label"/>
                        <TextField fx:id="txtNacionalidad" GridPane.rowIndex="5" GridPane.columnIndex="1"/>

                        <!-- Dates & Magic -->
                        <Label text="%edit.label.born" GridPane.rowIndex="6" GridPane.columnIndex="0" styleClass="field-label"/>
                        <TextField fx:id="txtNacimiento" GridPane.rowIndex="6" GridPane.columnIndex="1" promptText="DD-MM-YYYY"/>

                        <Label text="%edit.label.died" GridPane.rowIndex="7" GridPane.columnIndex="0" styleClass="field-label"/>
                        <TextField fx:id="txtMuerte" GridPane.rowIndex="7" GridPane.columnIndex="1"/>

                        <Label text="%edit.label.patronus" GridPane.rowIndex="8" GridPane.columnIndex="0" styleClass="field-label"/>
                        <TextField fx:id="txtPatronus" GridPane.rowIndex="8" GridPane.columnIndex="1"/>
                        
                        <Label text="%edit.label.animagus" GridPane.rowIndex="9" GridPane.columnIndex="0" styleClass="field-label"/>
                        <TextField fx:id="txtAnimago" GridPane.rowIndex="9" GridPane.columnIndex="1"/>

                        <Label text="%edit.label.wand" GridPane.rowIndex="10" GridPane.columnIndex="0" styleClass="field-label"/>
                        <TextField fx:id="txtVarita" GridPane.rowIndex="10" GridPane.columnIndex="1"/>
                    </GridPane>
                </HBox>

                <!-- SECTION 2: EXTENDED DETAIL (Visible) -->
                <!-- Alias & Titles are often important enough to be visible -->
                <GridPane hgap="15" vgap="10">
                     <columnConstraints>
                        <ColumnConstraints hgrow="NEVER" minWidth="100"/>
                        <ColumnConstraints hgrow="ALWAYS"/>
                    </columnConstraints>
                    
                    <Label text="%edit.label.alias" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                    <TextArea fx:id="txtAlias" GridPane.rowIndex="0" GridPane.columnIndex="1" prefRowCount="2"/>

                    <Label text="%edit.label.titles" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                    <TextArea fx:id="txtTitulos" GridPane.rowIndex="1" GridPane.columnIndex="1" prefRowCount="2"/>
                </GridPane>

                <!-- TOGGLE BUTTON -->
                <Button fx:id="btnToggleAdvanced" text="%edit.toggle.advanced.show" styleClass="toggle-button" maxWidth="Infinity"/>

                <!-- SECTION 3: ADVANCED (Hidden by default) -->
                <VBox fx:id="boxAdvanced" spacing="20" visible="false" managed="false">
                    
                    <!-- Physical Traits -->
                    <Label text="%edit.section.physical" styleClass="section-header"/>
                    <GridPane hgap="15" vgap="10">
                        <columnConstraints>
                            <ColumnConstraints hgrow="NEVER" minWidth="100"/>
                            <ColumnConstraints hgrow="ALWAYS"/>
                            <ColumnConstraints hgrow="NEVER" minWidth="100"/>
                            <ColumnConstraints hgrow="ALWAYS"/>
                        </columnConstraints>

                        <Label text="%edit.label.eyes" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                        <TextField fx:id="txtOjos" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                        <Label text="%edit.label.hair" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                        <TextField fx:id="txtPelo" GridPane.columnIndex="3" GridPane.rowIndex="0"/>

                        <Label text="%edit.label.skin" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                        <TextField fx:id="txtPiel" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                        <Label text="%edit.label.height" GridPane.columnIndex="2" GridPane.rowIndex="1"/>
                        <TextField fx:id="txtAltura" GridPane.columnIndex="3" GridPane.rowIndex="1"/>
                        
                        <Label text="%edit.label.weight" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                        <TextField fx:id="txtPeso" GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                    </GridPane>

                    <!-- Extra Magic & Bio -->
                    <Label text="%edit.section.additional" styleClass="section-header"/>
                    <GridPane hgap="15" vgap="10">
                        <columnConstraints>
                            <ColumnConstraints hgrow="NEVER" minWidth="100"/>
                            <ColumnConstraints hgrow="ALWAYS"/>
                        </columnConstraints>

                        <Label text="%edit.label.boggart" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                        <TextField fx:id="txtBoggart" GridPane.rowIndex="0" GridPane.columnIndex="1"/>

                        <Label text="%edit.label.family" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                        <TextArea fx:id="txtFamilia" GridPane.rowIndex="1" GridPane.columnIndex="1" prefRowCount="2"/>

                        <Label text="%edit.label.jobs" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                        <TextArea fx:id="txtTrabajos" GridPane.rowIndex="2" GridPane.columnIndex="1" prefRowCount="2"/>
                        
                        <Label text="%edit.label.romances" GridPane.rowIndex="3" GridPane.columnIndex="0"/>
                        <TextArea fx:id="txtRomances" GridPane.rowIndex="3" GridPane.columnIndex="1" prefRowCount="2"/>
                    </GridPane>
                </VBox>
            </VBox>
        </ScrollPane>
    </center>

    <bottom>
        <HBox spacing="15" alignment="CENTER_RIGHT" styleClass="form-footer">
            <padding>
                <Insets top="15" right="30" bottom="15" left="30"/>
            </padding>
            <Label fx:id="lblError" text="" styleClass="error-label"/>
            <Button fx:id="btnCancelar" text="%edit.button.cancel" styleClass="cancel-button"/>
            <Button fx:id="btnGuardar" text="%edit.button.save" styleClass="save-button"/>
        </HBox>
    </bottom>

</BorderPane>
